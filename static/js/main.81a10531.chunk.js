(this["webpackJsonpfull-stack-events-app"]=this["webpackJsonpfull-stack-events-app"]||[]).push([[0],{52:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n.n(a),s=n(41),i=n.n(s),l=n(13),o=n.n(l),u=n(19),d=n(8),j=(n(31),n(52),n(20),n(42)),b=n(43),h=n(24),m=n.n(h),v="https://fs-events-app.herokuapp.com/",p=function(){function e(t,n){Object(j.a)(this,e),this.token=t,this.logoutFunction=n}return Object(b.a)(e,[{key:"createUserAction",value:function(e,t,n){var c=this;return m()({method:e,url:t,headers:{authorization:this.token()},data:n}).catch((function(e){if(403===e.response)return c.logoutFunction(),Promise.reject();throw e}))}},{key:"logIn",value:function(){var e=Object(u.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m()({method:"post",url:"".concat(v,"auth"),data:{username:t,password:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"signUp",value:function(){var e=Object(u.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m()({method:"post",url:"".concat(v,"signup"),data:{username:t,password:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUser",value:function(e){return this.createUserAction("get","".concat(v,"user/").concat(e))}},{key:"updateUser",value:function(e,t){return this.createUserAction("put","".concat(v,"user/").concat(e),t)}},{key:"deleteUser",value:function(e){return this.createUserAction("delete","".concat(v,"user/").concat(e))}},{key:"createEvent",value:function(e){return this.createUserAction("post",v,e)}},{key:"getEvents",value:function(){return this.createUserAction("get",v)}},{key:"getEvent",value:function(e){return this.createUserAction("get","".concat(v).concat(e))}},{key:"deleteEvent",value:function(e){return this.createUserAction("delete","".concat(v).concat(e))}},{key:"updateEvent",value:function(e,t){return this.createUserAction("put","".concat(v).concat(e),t)}}]),e}(),O=n(18),x=n(80),f=n(85),g=n(84),y=n.p+"static/media/loading-gif.30c0aa7c.gif",w=function(e){var t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],s=n[1];return Object(c.jsx)(x.a,{className:"mt-5 d-flex justify-content-center",children:Object(c.jsxs)(f.a,{style:{width:"18rem"},children:[Object(c.jsx)(f.a.Header,{children:"Login"}),Object(c.jsxs)(f.a.Body,{children:[Object(c.jsxs)(g.a,{onSubmit:function(t){return function(t){t.preventDefault(),s(!0),e.apiClient.logIn(t.target.username.value,t.target.password.value).then((function(t){console.log(t);var n={username:t.data._doc.username,id:t.data._doc._id};e.logInFunc(n,t.data.token),s(!1)})).catch((function(e){s(!1),401===e.response.status?alert("Username or password incorrect"):alert("Sorry. Unable to log in at the moment.")}))}(t)},children:[Object(c.jsx)(g.a.Group,{controlId:"formBasicEmail",id:"login-form",children:Object(c.jsx)("input",{style:{width:"100%"},placeholder:"Username",className:"input-styled",type:"username",name:"username"})}),Object(c.jsx)(g.a.Group,{controlId:"formBasicPassword",children:Object(c.jsx)("input",{style:{width:"100%"},placeholder:"Password",className:"input-styled",type:"Password",name:"password"})}),Object(c.jsx)("button",{style:{width:"100%"},className:"my-2 btn button",type:"submit",disabled:r,children:r?Object(c.jsx)("img",{id:"loader",src:y,alt:"...loading"}):"login"})]}),Object(c.jsxs)("small",{children:["Username: mike",Object(c.jsx)("br",{})," Password: test"]})]})]})})},N=n(6),E=function(e){return e.loggedIn?Object(c.jsx)(N.a,{to:{pathname:"/events"}}):Object(c.jsx)(w,Object(O.a)({},e))},k=n(81),S=n(82),U=n(17),C=n.n(U),I=function(e){var t=e.logout,n=e.user,a=e.events,r=e.apiClient;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h2",{className:"mt-5",children:"Profile"}),Object(c.jsxs)(k.a,{className:"my-5",variant:"dark",bordered:!0,striped:!0,children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:"Username"}),Object(c.jsx)("td",{children:"Events in schedule"})]})}),Object(c.jsx)("tbody",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:n.username}),Object(c.jsx)("td",{children:function(e){var t=a.filter((function(e){return e.user===n.username}));return t.length}(n.username)})]})})]}),Object(c.jsx)(S.a,{variant:"btn button",className:"mr-3",onClick:t,children:"Logout"}),Object(c.jsx)("button",{className:"btn button-delete",onClick:function(){return e=n.id,void r.deleteUser(e).then((function(){C.a.success("Account Deleted!"),t()})).catch((function(e){C.a.warning("Sorry, unable to delete account at this time.")}));var e},children:"Delete Account"})]})},F=n(7),A=n.p+"static/media/plus-circle-solid.3a4d615f.svg",D=function(e){var t=e.filterEvents,n=e.allEvents;return Object(c.jsxs)("section",{className:"filter-bar my-5 rounded d-flex justify-content-between align-items-center",children:[Object(c.jsx)("div",{children:Object(c.jsxs)("h3",{children:[Object(c.jsx)("span",{className:"text-purple",children:n.length})," Events"]})}),Object(c.jsxs)("div",{className:"d-flex align-items-center",children:[Object(c.jsx)(g.a,{className:"mr-3",onChange:function(e){return t(e.target.value)},children:Object(c.jsxs)("select",{id:"filter",children:[Object(c.jsx)("option",{value:"all",children:"All Events"}),Object(c.jsx)("option",{value:"upcoming",children:"Upcoming Events"}),Object(c.jsx)("option",{value:"favourites",children:"Show Favourites"})]})}),Object(c.jsx)(F.b,{to:"/events/add",children:Object(c.jsxs)(S.a,{variant:"btn button",className:"d-flex align-items-center",children:[Object(c.jsx)("img",{height:"20px",className:"mr-1",src:A,alt:""}),"Add Event"]})})]})]})},T=n.p+"static/media/star-regular.128d02cb.svg",_=n.p+"static/media/star-solid.ad4ae2e6.svg",P=function(e){var t=e.events,n=e.favouriteEvent;return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(k.a,{responsive:"lg",variant:"dark",striped:!0,bordered:!0,hover:!0,children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{children:"Event"}),Object(c.jsx)("th",{children:"Details"}),Object(c.jsx)("th",{children:"Location"}),Object(c.jsx)("th",{children:"Added by"}),Object(c.jsx)("th",{children:"Manage"})]})}),Object(c.jsx)("tbody",{children:t.map((function(e){return Object(c.jsxs)("tr",{id:e._id,children:[Object(c.jsxs)("td",{children:[Object(c.jsx)("img",{className:"fav-star",alt:"",src:e.favourite?_:T,onClick:function(){return n(e._id)}}),e.name]}),Object(c.jsxs)("td",{className:"d-flex flex-column",children:[e.date,Object(c.jsxs)("span",{children:["Starts at ",e.time]})]}),Object(c.jsx)("td",{children:e.location}),Object(c.jsx)("td",{children:e.user}),Object(c.jsx)("td",{children:Object(c.jsx)(F.b,{to:"/events/update/".concat(e._id),children:Object(c.jsx)(S.a,{className:"w-100",variant:"btn button",children:"Manage Event"})})})]},e._id)}))})]})})},q=n(83),L=n.p+"static/media/user-circle-solid.0633ff3e.svg",V=function(){return Object(c.jsx)("header",{className:"mb-5",children:Object(c.jsx)(x.a,{children:Object(c.jsxs)("nav",{className:"py-3 d-flex",children:[Object(c.jsx)("h3",{className:"mr-3 text-light",href:"#home",children:"E V E N T"}),Object(c.jsx)(q.a,{className:"mr-auto",children:Object(c.jsx)(F.b,{to:"/events",className:"mr-3 nav-link text-light",children:"View Events"})}),Object(c.jsx)(F.b,{to:"/profile",children:Object(c.jsxs)(S.a,{variant:"btn",className:"mr-2 button d-flex align-items-center",children:[Object(c.jsx)("img",{height:"20px",className:"mr-1",src:L,alt:""}),"Profile"]})})]})})})},B=function(e){var t=e.user,n=e.apiClient,r=Object(a.useState)({}),s=Object(d.a)(r,2),i=s[0],l=s[1];return Object(c.jsxs)(g.a,{className:"mb-5",onChange:function(e){return function(e){l({name:e.currentTarget.name.value,date:e.currentTarget.date.value,time:e.currentTarget.time.value,location:e.currentTarget.location.value,description:e.currentTarget.description.value,favourite:!1,user:t.username})}(e)},onSubmit:function(e){return function(e){e.preventDefault(),n.createEvent(i).then((function(t){console.log(t),C.a.success(t.data.message),e.target.name.value="",e.target.date.value="",e.target.time.value="",e.target.location.value="",e.target.description.value=""})).catch((function(e){alert(e)}))}(e)},children:[Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"name",children:"Event Name"}),Object(c.jsx)("input",{type:"text",style:{width:"100%"},className:"input-styled",name:"name",required:!0})]}),Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"location",children:"Event Location"}),Object(c.jsx)("input",{type:"text",style:{width:"100%"},className:"input-styled",name:"location",required:!0})]}),Object(c.jsxs)("div",{className:"form-group row",children:[Object(c.jsxs)("div",{className:"col",children:[Object(c.jsx)("label",{htmlFor:"date",children:"Event Date"}),Object(c.jsx)("input",{type:"date",name:"date",style:{width:"100%"},className:"input-styled",required:!0})]}),Object(c.jsxs)("div",{className:"col",children:[Object(c.jsx)("label",{htmlFor:"time",children:"Event Time"}),Object(c.jsx)("input",{type:"time",name:"time",style:{width:"100%"},className:"input-styled",required:!0})]})]}),Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"description",children:"Event Description"}),Object(c.jsx)("textarea",{style:{width:"100%"},className:"input-styled",name:"description",rows:"3"})]}),Object(c.jsx)("button",{type:"submit",className:"btn button mr-3",children:"Add Event"}),Object(c.jsx)(F.b,{to:"/events",children:Object(c.jsx)(S.a,{variant:"outline-light",children:"Cancel"})})]})},J=function(e){var t=e.eventId,n=e.apiClient,r=Object(a.useState)({_id:"",date:"",description:"",favourite:void 0,location:"",name:"",time:"",user:""}),s=Object(d.a)(r,2),i=s[0],l=s[1],o=Object(a.useState)(!1),u=Object(d.a)(o,2),j=u[0],b=u[1];Object(a.useEffect)((function(){n.getEvent(t).then((function(e){var t=e.data[0];l({_id:t._id,date:t.date,description:t.description,favourite:t.favourite,location:t.location,name:t.name,time:t.time,user:t.user})})).catch((function(e){console.log(e)}))}),[]);return j?Object(c.jsx)(N.a,{to:"/events"}):Object(c.jsxs)(g.a,{className:"mb-5",onChange:function(e){return function(e){e.preventDefault();var t={name:e.currentTarget.name.value,location:e.currentTarget.location.value,time:e.currentTarget.time.value,date:e.currentTarget.date.value,description:e.currentTarget.description.value};l((function(e){return Object(O.a)(Object(O.a)({},e),t)}))}(e)},onSubmit:function(e){return function(e){e.preventDefault(),n.updateEvent(i._id,i).then((function(){C.a.success("Event updated"),b(!0)})).catch((function(e){console.error(e)}))}(e)},children:[Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"name",children:"Event Name"}),Object(c.jsx)("input",{defaultValue:i.name,type:"text",style:{width:"100%"},className:"input-styled",name:"name",required:!0})]}),Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"location",children:"Event Location"}),Object(c.jsx)("input",{defaultValue:i.location,type:"text",style:{width:"100%"},className:"input-styled",name:"location",required:!0})]}),Object(c.jsxs)("div",{className:"form-group row",children:[Object(c.jsxs)("div",{className:"col",children:[Object(c.jsx)("label",{htmlFor:"date",children:"Event Date"}),Object(c.jsx)("input",{defaultValue:i.date,type:"date",name:"date",style:{width:"100%"},className:"input-styled",required:!0})]}),Object(c.jsxs)("div",{className:"col",children:[Object(c.jsx)("label",{htmlFor:"time",children:"Event Time"}),Object(c.jsx)("input",{defaultValue:i.time,type:"time",name:"time",style:{width:"100%"},className:"input-styled",required:!0})]})]}),Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"description",children:"Event Description"}),Object(c.jsx)("textarea",{defaultValue:i.description,style:{width:"100%"},className:"input-styled",name:"description",rows:"3"})]}),Object(c.jsx)("button",{type:"submit",className:"btn button mr-3",children:"Update Event"}),Object(c.jsx)("button",{type:"button",onClick:function(){return e=i._id,void n.deleteEvent(e).then((function(){C.a.success("Event deleted"),b(!0)})).catch((function(e){C.a.danger("Unable to delete event")}));var e},className:"btn button-delete mr-3",children:"Delete Event"}),Object(c.jsx)(F.b,{to:"/events",children:Object(c.jsx)(S.a,{className:"btn",variant:"outline-light",children:"Cancel"})})]})},M=function(e){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(V,{}),Object(c.jsx)(x.a,{children:Object(c.jsx)(I,{logout:e.logout,user:e.user,events:e.events,apiClient:e.apiClient})})]})},G=function(e){var t=e.user,n=e.apiClient;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(V,{}),Object(c.jsxs)(x.a,{children:[Object(c.jsx)("h3",{className:"my-5",children:"Add Event"}),Object(c.jsx)(B,{user:t,apiClient:n})]})]})},z=function(e){var t=e.apiClient,n=(e.user,Object(a.useState)([])),r=Object(d.a)(n,2),s=r[0],i=r[1],l=Object(a.useState)([]),j=Object(d.a)(l,2),b=j[0],h=j[1],m=function(){var e=Object(u.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEvents();case 2:n=e.sent,i(n.data),h(n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){m()}),[]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(V,{}),Object(c.jsxs)(x.a,{children:[Object(c.jsx)(D,{filterEvents:function(e){if("favourites"===e){var t=s.filter((function(e){return e.favourite}));h(t)}else if("upcoming"===e){var n=new Date,c=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),r=n.getFullYear();n=a+"/"+c+"/"+r,console.log(n);var i=s.filter((function(e){return new Date(e.date)>new Date(n)})).sort((function(e,t){return new Date(e.date)-new Date(t.date)}));h(i)}else h(s)},allEvents:s}),Object(c.jsx)(P,{events:b,apiClient:t,favouriteEvent:function(e){var n=s.filter((function(t){return t._id===e})),c=Object(d.a)(n,1)[0];c.favourite=!c.favourite,t.updateEvent(e,c).then((function(){m()})).catch((function(e){console.log(e)}))}})]})]})},H=function(e){var t=e.apiClient,n=Object(N.g)();return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(V,{}),Object(c.jsxs)(x.a,{children:[Object(c.jsx)("h3",{className:"my-5",children:"Update Event"}),Object(c.jsx)(J,{apiClient:t,eventId:n.id})]})]})},Y=n(45),K=function(e){var t=e.loggedIn,n=e.children,a=Object(Y.a)(e,["loggedIn","children"]);return Object(c.jsx)(N.b,Object(O.a)(Object(O.a)({},a),{},{render:function(){return t?n:Object(c.jsx)(N.a,{to:{pathname:"/"}})}}))},Q=void 0,R=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)({}),i=Object(d.a)(s,2),l=i[0],j=i[1],b=Object(a.useState)([]),h=Object(d.a)(b,2),m=h[0],v=h[1],O=new p((function(){return window.localStorage.getItem("EventsAppUserToken")}),(function(){return Q.logout()})),x=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getEvents();case 2:t=e.sent,v(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){if(x(),localStorage.getItem("EventsAppUserToken")){var e=localStorage.getItem("EventsAppUser");j(JSON.parse(e)),r(!0)}else r(!1)}),[]);var f=function(e,t){j(e),window.localStorage.setItem("EventsAppUser",JSON.stringify(e)),window.localStorage.setItem("EventsAppUserToken",t),r(!0)};return Object(c.jsx)("div",{id:"App",children:Object(c.jsx)(F.a,{children:Object(c.jsxs)(N.d,{children:[Object(c.jsx)(N.b,{exact:!0,path:"/",render:function(){return Object(c.jsx)(E,{apiClient:O,loggedIn:n,logInFunc:f})}}),Object(c.jsx)(K,{exact:!0,path:"/events",loggedIn:n,children:Object(c.jsx)(z,{loggedIn:n,apiClient:O,user:l})}),Object(c.jsx)(K,{exact:!0,path:"/events/add",loggedIn:n,children:Object(c.jsx)(G,{loggedIn:n,apiClient:O,user:l})}),Object(c.jsx)(K,{exact:!0,path:"/events/update/:id",loggedIn:n,children:Object(c.jsx)(H,{loggedIn:n,events:m,apiClient:O,user:l})}),Object(c.jsx)(K,{exact:!0,path:"/profile",loggedIn:n,children:Object(c.jsx)(M,{loggedIn:n,logout:function(){window.localStorage.removeItem("EventsAppUser"),window.localStorage.removeItem("EventsAppUserToken"),r(!1),j({})},events:m,apiClient:O,user:l})})]})})})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,86)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(R,{})}),document.getElementById("root")),W()}},[[79,1,2]]]);
//# sourceMappingURL=main.81a10531.chunk.js.map