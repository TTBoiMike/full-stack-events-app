(this["webpackJsonpfull-stack-events-app"]=this["webpackJsonpfull-stack-events-app"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),s=n.n(a),c=n(26),i=n.n(c),o=(n(73),n(9)),l=n(10),u=n(12),d=n(11),h=n(27),j=n.n(h),b=(n(51),n(110)),p=n(108),v=n(105),f=n(106),m=(n(52),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={loginDisabled:!1,signupDisabled:!1},r}return Object(l.a)(n,[{key:"submitLogin",value:function(e){var t=this;e.preventDefault(),this.setState({loginDisabled:!0}),this.props.client.logIn(e.target.username.value,e.target.password.value).then((function(e){t.setState({loginDisabled:!1});var n=e.data._doc._id;t.props.login(n,e.data.token)})).catch((function(e){alert("Unable to login at this time"),console.log(e),t.setState({loginDisabled:!1})}))}},{key:"submitSignUp",value:function(e){var t=this;e.preventDefault(),this.setState({signupDisabled:!0}),this.props.client.signUp(e.target.username.value,e.target.password.value).then((function(n){200===n.status?j.a.success("User created: ".concat(e.target.username.value)):j.a.error("An error occured."),t.setState({signupDisabled:!1})})).catch((function(e){alert("Unable to signup at this time"),console.log(e),t.setState({signupDisabled:!1})})).finally((function(){return document.getElementById("signup-form").reset()}))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)(v.a,{className:"mt-5 d-flex justify-content-center",children:[Object(r.jsxs)(b.a,{style:{width:"18rem"},children:[Object(r.jsx)(b.a.Header,{children:"Login"}),Object(r.jsx)(b.a.Body,{children:Object(r.jsxs)(p.a,{onSubmit:function(t){return e.submitLogin(t)},children:[Object(r.jsxs)(p.a.Group,{controlId:"formBasicEmail",id:"login-form",children:[Object(r.jsx)(p.a.Label,{children:"Username"}),Object(r.jsx)(p.a.Control,{type:"username",name:"username"})]}),Object(r.jsxs)(p.a.Group,{controlId:"formBasicPassword",children:[Object(r.jsx)(p.a.Label,{children:"Password"}),Object(r.jsx)(p.a.Control,{type:"Password",name:"password"})]}),Object(r.jsx)(f.a,{variant:"primary",type:"submit",children:"Login"})]})})]}),Object(r.jsxs)(b.a,{style:{width:"18rem"},children:[Object(r.jsx)(b.a.Header,{children:"Signup"}),Object(r.jsx)(b.a.Body,{children:Object(r.jsxs)(p.a,{onSubmit:function(t){return e.submitSignUp(t)},id:"signup-form",children:[Object(r.jsxs)(p.a.Group,{controlId:"formBasicEmail",children:[Object(r.jsx)(p.a.Label,{children:"Create Username"}),Object(r.jsx)(p.a.Control,{type:"username",name:"username",required:!0})]}),Object(r.jsxs)(p.a.Group,{controlId:"formBasicPassword",children:[Object(r.jsx)(p.a.Label,{children:"Create Password"}),Object(r.jsx)(p.a.Control,{type:"Password",name:"password",required:!0})]}),Object(r.jsx)(f.a,{variant:"primary",type:"submit",children:"Signup"})]})})]})]})}}]),n}(s.a.Component)),O=n(29),x=n(20),g=n.n(x),y=n(28),E=n(109),k=n(66),w=n(18),N=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(r.jsx)("div",{children:Object(r.jsx)(E.a,{bg:"light",variant:"light",className:"mb-5",children:Object(r.jsxs)(v.a,{children:[Object(r.jsx)(w.b,{to:"/",className:"mr-3",children:Object(r.jsx)(E.a.Brand,{href:"#home",children:"E V E N T"})}),Object(r.jsx)(k.a,{className:"mr-auto",children:Object(r.jsx)(w.b,{to:"/",className:"mr-3 nav-link",children:"My Events"})}),Object(r.jsx)(w.b,{to:"/profile",children:Object(r.jsx)(f.a,{variant:"btn btn-dark",className:"mr-2",children:"Profile"})}),Object(r.jsx)(f.a,{variant:"outline-dark",onClick:function(){return e.props.logout()},children:"Logout"})]})})})}}]),n}(s.a.Component),U=n(6),S=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={event:{name:"",location:"",date:"",time:"",description:"",favourite:!1},disabled:!1,updating:!1,redirectToReferrer:!1},r}return Object(l.a)(n,[{key:"manageEventUpdate",value:function(e){var t=this;e&&(this.setState({updating:!0}),this.props.client.getEvent(e).then((function(e){var n=e.data[0],r=n.name,a=n.location,s=n.date,c=n.time,i=n.description,o=n.favourite;t.setState({event:{name:r,location:a,date:s,time:c,description:i,favourite:o}})})))}},{key:"componentDidMount",value:function(){this.props.match&&this.manageEventUpdate(this.props.match.params.id)}},{key:"formReset",value:function(e){this.setState({event:{name:"",location:"",date:"",time:"",description:"",favourite:!1}})}},{key:"handleFormChange",value:function(e){e.preventDefault();var t=this.state.event;t[e.target.name]=e.target.value,this.setState({event:t})}},{key:"submitNewEvent",value:function(e){var t=this;if(e.preventDefault(),this.state.updating)this.props.client.updateEvent(this.props.match.params.id,this.state.event).then((function(){return t.props.fetchEvents()}));else{var n=this.props.userInfo.userName;this.props.client.createEvent(Object(O.a)(Object(O.a)({},this.state.event),{},{user:n})).then((function(){t.props.fetchEvents()}))}this.formReset(e),this.setState({updating:!1,redirectToReferrer:!0})}},{key:"render",value:function(){var e=this;return this.state.redirectToReferrer?Object(r.jsx)(U.a,{to:"/"}):Object(r.jsxs)(p.a,{onChange:function(t){return e.handleFormChange(t)},onSubmit:function(t){return e.submitNewEvent(t)},children:[Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{htmlFor:"name",children:"Event Name"}),Object(r.jsx)("input",{type:"text",className:"form-control",name:"name",value:this.state.event.name,required:!0})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{htmlFor:"location",children:"Event Location"}),Object(r.jsx)("input",{type:"text",className:"form-control",name:"location",value:this.state.event.location,required:!0})]}),Object(r.jsxs)("div",{className:"form-group row",children:[Object(r.jsxs)("div",{className:"col",children:[Object(r.jsx)("label",{htmlFor:"date",children:"Event Date"}),Object(r.jsx)("input",{type:"date",name:"date",className:"form-control",value:this.state.event.date,required:!0})]}),Object(r.jsxs)("div",{className:"col",children:[Object(r.jsx)("label",{htmlFor:"time",children:"Event Time"}),Object(r.jsx)("input",{type:"time",name:"time",className:"form-control",value:this.state.event.time,required:!0})]})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{htmlFor:"description",children:"Event Description"}),Object(r.jsx)("textarea",{className:"form-control",name:"description",rows:"3",value:this.state.event.description})]}),Object(r.jsx)("button",{type:"submit",className:"btn btn-dark mr-3",disabled:this.state.disabled,children:this.state.updating?"Update Event":"Add Event"}),Object(r.jsx)(f.a,{variant:"outline-dark",onClick:function(){return e.setState({redirectToReferrer:!0})},children:"Cancel"})]})}}]),n}(s.a.Component),I=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"handleFilterInputs",value:function(e){var t=e.currentTarget.filter.value;this.props.filterFunction(e,t)}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:"filter-bar mb-5 p-3 d-flex justify-content-between rounded",children:[Object(r.jsx)(p.a,{className:"d-flex align-items-center",onChange:function(t){return e.handleFilterInputs(t)},children:Object(r.jsxs)("select",{class:"custom-select",id:"filter",children:[Object(r.jsx)("option",{value:"recently-added",selected:!0,children:"Recently Added"}),Object(r.jsx)("option",{value:"by-date",children:"Filter by Date"}),Object(r.jsx)("option",{value:"favourites",children:"Show Favourites"})]})}),Object(r.jsx)(w.b,{to:"/add",children:Object(r.jsx)(f.a,{className:"btn btn-dark",children:"Add Event"})})]})}}]),n}(s.a.Component),C=n(65),D=n(107),F=n.p+"static/media/star-regular.8d41e0b0.svg",A=n.p+"static/media/star-solid.ad4ae2e6.svg",L=(n(83),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).deleteEvent=function(t){e.props.client.deleteEvent(t).then((function(){return e.props.fetchEvents()}))},e.favouriteEvent=function(t){var n=e.props.events.filter((function(e){return e._id===t})),r=Object(C.a)(n,1)[0];r.favourite=!r.favourite,e.props.client.updateEvent(t,r).then((function(){return e.props.fetchEvents()}))},e.buildEventRows=function(){return e.props.events.map((function(t){return Object(r.jsxs)("tr",{id:t._id,children:[Object(r.jsxs)("td",{children:[Object(r.jsx)("img",{className:"fav-star",src:t.favourite?A:F,onClick:function(n){return e.favouriteEvent(t._id)}}),t.name]}),Object(r.jsx)("td",{children:t.date}),Object(r.jsx)("td",{children:t.location}),Object(r.jsx)("td",{children:t.description}),Object(r.jsxs)("td",{children:[Object(r.jsx)(w.b,{to:"/update/".concat(t._id),children:Object(r.jsx)(f.a,{variant:"btn btn-dark",children:"Update"})}),Object(r.jsx)(f.a,{variant:"outline-dark",onClick:function(){return e.deleteEvent(t._id)},children:"delete"})]}),Object(r.jsx)("td",{children:t.user})]})}))},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(r.jsx)("div",{children:Object(r.jsxs)(D.a,{responsive:"lg",striped:!0,bordered:!0,hover:!0,children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Event"}),Object(r.jsx)("th",{children:"Date"}),Object(r.jsx)("th",{children:"Location"}),Object(r.jsx)("th",{children:"Description"}),Object(r.jsx)("th",{children:"Action"}),Object(r.jsx)("th",{children:"Added by"})]})}),Object(r.jsx)("tbody",{children:this.buildEventRows()})]})})}}]),n}(s.a.Component)),P=n(67),B=n(50),T=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"calcUserEvents",value:function(){var e=this;return this.props.events.filter((function(t){return t.user===e.props.userInfo.userName})).length}},{key:"submitProfileUpdate",value:function(e,t){var n=this;e.preventDefault();var r=e.currentTarget.username.value;this.props.client.updateUser(t,{username:r}).then((function(e){200===e.status?(j.a.success(e.data),n.props.updateUserName(r)):j.a.warning(e.data)})).finally((function(){return document.getElementById("account-form").reset()}))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"My Profile"}),Object(r.jsxs)(P.a,{className:"mt-5",defaultActiveKey:"home",id:"uncontrolled-tab-example",children:[Object(r.jsx)(B.a,{eventKey:"home",title:"Account Details",children:Object(r.jsxs)(D.a,{className:"mt-3",bordered:!0,striped:!0,children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"Username"}),Object(r.jsx)("td",{children:"Events in schedule"})]})}),Object(r.jsx)("tbody",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:this.props.userInfo.userName}),Object(r.jsx)("td",{children:this.calcUserEvents()})]})})]})}),Object(r.jsx)(B.a,{eventKey:"profile",title:"Edit Account",children:Object(r.jsxs)(p.a,{className:"mt-3",id:"account-form",onSubmit:function(t){return e.submitProfileUpdate(t,e.props.userInfo.userId)},children:[Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{htmlFor:"username",children:" Change Username"}),Object(r.jsx)("input",{type:"text",className:"form-control",id:"username",name:"username",placeholder:"new username"})]}),Object(r.jsx)(f.a,{type:"submit",variant:"dark",children:"Submit"})]})})]})]})}}]),n}(s.a.Component),R=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).filterEvents=function(e,t){if(e.preventDefault(),"by-date"===t){var n=r.state.allEvents.sort((function(e,t){return new Date(e.date)-new Date(t.date)}));r.setState({filteredEvents:n})}else if("favourites"===t){var a=r.state.allEvents.filter((function(e){return!0===e.favourite}));r.setState({filteredEvents:a})}else r.fetchEvents()},r.fetchEvents=Object(y.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.client.getEvents();case 2:t=e.sent,r.setState({allEvents:t.data,filteredEvents:t.data});case 4:case"end":return e.stop()}}),e)}))),r.fetchUser=function(){var e=Object(y.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.client.getUser(t);case 2:n=e.sent,r.setState({user:{userId:t,userName:n.data.username}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.updateUserName=function(e){r.setState({user:{userName:e}})},r.state={user:{userId:"",userName:""},allEvents:[],filteredEvents:[]},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.fetchEvents(),this.fetchUser(this.props.userId)}},{key:"render",value:function(){var e=this;return Object(r.jsx)("div",{children:Object(r.jsxs)(w.a,{children:[Object(r.jsx)(N,{logout:this.props.logout}),Object(r.jsx)(v.a,{children:Object(r.jsxs)(U.d,{children:[Object(r.jsxs)(U.b,{exact:!0,path:"/",children:[Object(r.jsx)("h1",{className:"mb-5",children:"My EVENTS"}),Object(r.jsx)(I,{filterFunction:this.filterEvents}),Object(r.jsx)(L,{client:this.props.client,events:this.state.filteredEvents,fetchEvents:this.fetchEvents,updateEvent:this.updateEvent})]}),Object(r.jsx)(U.b,{exact:!0,path:"/add",children:Object(r.jsx)(S,{userInfo:this.state.user,client:this.props.client,fetchEvents:this.fetchEvents,updating:this.state.updating})}),Object(r.jsx)(U.b,{exact:!0,path:"/update/:id",render:function(t){return Object(r.jsx)(S,Object(O.a)(Object(O.a)({},t),{},{client:e.props.client,fetchEvents:e.fetchEvents}))}}),Object(r.jsx)(U.b,{exact:!0,path:"/profile",children:Object(r.jsx)(T,{updateUserName:this.updateUserName,userInfo:this.state.user,client:this.props.client,events:this.state.allEvents})})]})})]})})}}]),n}(s.a.Component),_=n(43),q=n.n(_),M="https://fs-events-app.herokuapp.com/",G=function(){function e(t,n){Object(o.a)(this,e),this.token=t,this.logoutFunction=n}return Object(l.a)(e,[{key:"createUserAction",value:function(e,t,n){var r=this;return q()({method:e,url:t,headers:{authorization:this.token()},data:n}).catch((function(e){if(403===e.response)return r.logoutFunction(),Promise.reject();throw e}))}},{key:"logIn",value:function(){var e=Object(y.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q()({method:"post",url:"".concat(M,"auth"),data:{username:t,password:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"signUp",value:function(){var e=Object(y.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q()({method:"post",url:"".concat(M,"signup"),data:{username:t,password:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUser",value:function(e){return this.createUserAction("get","".concat(M,"user/").concat(e))}},{key:"updateUser",value:function(e,t){return this.createUserAction("put","".concat(M,"user/").concat(e),t)}},{key:"createEvent",value:function(e){return this.createUserAction("post",M,e)}},{key:"getEvents",value:function(){return this.createUserAction("get",M)}},{key:"getEvent",value:function(e){return this.createUserAction("get","".concat(M).concat(e))}},{key:"deleteEvent",value:function(e){return this.createUserAction("delete","".concat(M).concat(e))}},{key:"updateEvent",value:function(e,t){return this.createUserAction("put","".concat(M).concat(e),t)}}]),e}(),K=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).login=function(e,t){window.localStorage.setItem("token",t),window.localStorage.setItem("UserId",e),r.setState({token:t,userId:e})},r.logout=function(){window.localStorage.removeItem("token"),window.localStorage.removeItem("UserId"),r.setState({token:void 0})},r.state={token:window.localStorage.getItem("token"),userId:window.localStorage.getItem("UserId")},r.apiClient=new G((function(){return r.state.token}),(function(){return r.logout()})),r}return Object(l.a)(n,[{key:"render",value:function(){return this.state.token?Object(r.jsx)(R,{userId:this.state.userId,client:this.apiClient,logout:this.logout}):Object(r.jsx)(m,{login:this.login,client:this.apiClient})}}]),n}(s.a.Component),H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,111)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};i.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(K,{})}),document.getElementById("root")),H()},73:function(e,t,n){},83:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.80e2cd7d.chunk.js.map